select dept_id,max(salaray) over (partition by dept_id) as max_sal ,a.* from employees a 
/
select dept_id ,lag(salaray,1,0) over (partition by dept_id order by salaray) ,a.* from employees a 
/

